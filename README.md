# Reflection Module 6

- [Commit 1](#commit-1-reflection-notes)

## Commit 1 Reflection Notes
Function `handle_connection` yang ada di `main.rs` akan mencetak *raw HTTP Request* yang dikirimkan oleh pengguna (dalam kasus ini saya sendiri) yang menjumpai web server yang saya jalankan. Function tersebut menerima sebuah *mutable* `TcpStream` sebagai parameter, yang kemudian akan diberikan *reference* nya ke `BufReader`. Dengan `BufReader`, *HTTP Request* yang dikirimkan akan displit berdasarkan karakter *newline* dan atau CRLF, kemudian di lakukan `unwrap()` karena method `lines()` mengembalikan sebuah struktur `Result<String, Error>`. Hasil dari `unwrap()` ini akan diiterasikan semua dan diambil *value* nya selama baris sekarang bukanlah sebuah baris kosong. Hasil *parsing* ini merupakan sebuah `Vector` atau secara sederhana array yang panjangnya bisa diubah, kemudian dicetak ke layar.

## Commit 2 Reflection Notes
Function `handle_connection` yang baru akan mengirimkan *raw HTTP Response* dengan status `200 OK`. Di dalam respon tersebut, akan dicantumkan data `HTML` agar jika *HTTP Request* dikirimkan dari sebuah browser, orang yang mengirimkannya dapat melihat respon dari server secara langsung di browser. Untuk mengirimkan data `HTML` itu dalam respon, diperlukan juga header `Content-Length` di *HTTP Response* nya agar browser tau sepanjang apa *body* dari respon yang dikirimkan server. Berikut adalah *screenshot* hasil menjalankan kode baru.
![Gambar menjalankan server dengan mengirimkan raw HTTP response](./commit2.png)

## Commit 3 Reflection Notes
Setelah di modifikasi lagi, function `handle_connection` sekarang akan mengirimkan *raw HTTP Response* berdasarkan status *HTTP Request* yang diterima. Ketika *HTTP Request* yang dikirim merupakan `GET Request`, URI yang diminta adalah `/`, serta versi HTTP `HTTP/1.1`, server akan mengembalikan HTML `hello.html`. Di lain sisi, jika *request* yang dikirim selain dari yang telah dijelaskan sebelumnya, server akan mengembalikan HTML `404.html`. Cara untuk membedakan cukup simpel, yaitu ambil saja baris pertama dari *raw HTTP Request* yang didapatkan lalu langsung di cek apakah sama dengan string `GET / HTTP/1.1` atau tidak. Yang dilakukan function `handle_connection` ini sekarang sudah mirip seperti *routing*, tergantung dari *request* yang di buat, server akan mengembalikan halaman HTML yang terkait. Namun, ketika pertama membuat kode ini dengan mengikuti Chapter 20 dari buku yang terkait, terdapat duplikasi kode yang sangat jelas terlihat, yaitu di bagian *conditional* untuk melihat apakah *request* yang dikirimkan akan mengembalikan HTML `hello.html` atau tidak. Oleh karena itu, kode tersebut harus di *refactor* agar duplikasi tersebut bisa dihilangkan. Saya mengikuti langkah-langkah *refactoring* yang terdapat dalam buku, yang mengeluarkan `status_line` serta nama file HTML yang akan dikembalikan untuk di *assign* valuenya berdasarkan hasil *request* yang diterima. Cara *assignment* ini mirip dengan ternary operator namun lebih *verbose*.
![Gambar server mengirimkan 404 ketika meminta URI lain selain /](./commit3.png)
